# Claude Code è®¤è¯å†²çªè§£å†³æ–¹æ¡ˆæ€»ç»“

## ğŸ” é—®é¢˜åˆ†æ

### åŸå§‹é”™è¯¯
```
â€¼Auth conflict: Using ANTHROPIC_API_KEY instead of Anthropic Console key. 
Either unset ANTHROPIC_API_KEY, or run `claude /logout`.
```

### é—®é¢˜åŸå› 
Claude CodeåŒæ—¶æ£€æµ‹åˆ°äº†ï¼š
1. **ç¯å¢ƒå˜é‡ä¸­çš„APIå¯†é’¥** (`ANTHROPIC_API_KEY`)
2. **Anthropic Consoleçš„ç™»å½•ä¿¡æ¯** (å­˜å‚¨åœ¨ `~/.claude/` ç›®å½•)

è¿™å¯¼è‡´äº†è®¤è¯å†²çªã€‚

## âœ… è§£å†³æ­¥éª¤

### ç¬¬1æ­¥: ç™»å‡ºConsoleè®¤è¯
```bash
claude /logout
```
âœ… **å·²å®Œæˆ** - æˆåŠŸç™»å‡ºConsole

### ç¬¬2æ­¥: æ¸…é™¤Consoleè®¤è¯æ–‡ä»¶
```powershell
Remove-Item "$env:USERPROFILE\.claude" -Recurse -Force -ErrorAction SilentlyContinue
```
âœ… **å·²å®Œæˆ** - åˆ é™¤äº†Consoleè®¤è¯æ–‡ä»¶

### ç¬¬3æ­¥: è®¾ç½®ç¯å¢ƒå˜é‡
```powershell
$env:ANTHROPIC_BASE_URL = "https://api.moonshot.cn/v1"
$env:ANTHROPIC_API_KEY = "sk-uUsX6dX28RqxdLqgYIgjiLzUU4lx9osHdWjRQBYzsxxJbfti"
```
âœ… **å·²å®Œæˆ** - ç¯å¢ƒå˜é‡å·²è®¾ç½®

## ğŸ”„ å½“å‰çŠ¶æ€

### è®¤è¯å†²çª: âœ… å·²è§£å†³
- ä¸å†æ˜¾ç¤º "Auth conflict" é”™è¯¯
- Claude Codeç°åœ¨å¯ä»¥å¯åŠ¨

### æ–°é—®é¢˜: APIç«¯ç‚¹
Claude Codeç°åœ¨å°è¯•è¿æ¥ `api.anthropic.com` è€Œä¸æ˜¯æœˆä¹‹æš—é¢APIï¼Œæ˜¾ç¤ºï¼š
```
Failed to connect to api.anthropic.com: ERR_BAD_REQUEST
```

## ğŸ› ï¸ æœ€ç»ˆè§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1: ä½¿ç”¨Claude Code Router (æ¨è)
ç¡®ä¿ `~/.claude-code-router/config.json` é…ç½®æ­£ç¡®ï¼š

```json
{
  "LOG": true,
  "Providers": [
    {
      "name": "kimi2",
      "api_base_url": "https://api.moonshot.cn/v1",
      "api_key": "sk-uUsX6dX28RqxdLqgYIgjiLzUU4lx9osHdWjRQBYzsxxJbfti",
      "models": [
        "moonshot-v1-8k",
        "moonshot-v1-32k",
        "moonshot-v1-128k"
      ],
      "transformer": {
        "use": ["openai"]
      }
    }
  ],
  "Router": {
    "default": "kimi2,moonshot-v1-8k"
  }
}
```

### æ–¹æ¡ˆ2: å¼ºåˆ¶ç¯å¢ƒå˜é‡
åˆ›å»ºå¯åŠ¨è„šæœ¬ç¡®ä¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆï¼š

```powershell
# start-claude-kimi.ps1
$env:ANTHROPIC_BASE_URL = "https://api.moonshot.cn/v1"
$env:ANTHROPIC_API_KEY = "sk-uUsX6dX28RqxdLqgYIgjiLzUU4lx9osHdWjRQBYzsxxJbfti"
& claude $args
```

### æ–¹æ¡ˆ3: é‡æ–°å®‰è£…Claude Code
å¦‚æœä»¥ä¸Šæ–¹æ¡ˆéƒ½ä¸è¡Œï¼Œå»ºè®®å®Œå…¨é‡è£…ï¼š
```bash
# è¿è¡Œä¹‹å‰åˆ›å»ºçš„é‡è£…è„šæœ¬
reinstall-claude-oneclick.bat
```

## ğŸ“‹ éªŒè¯æ­¥éª¤

### 1. æ£€æŸ¥è®¤è¯å†²çªæ˜¯å¦è§£å†³
```bash
claude --version
```
åº”è¯¥æ˜¾ç¤ºç‰ˆæœ¬å·è€Œä¸æ˜¯è®¤è¯å†²çªé”™è¯¯ã€‚

### 2. æ£€æŸ¥APIè¿æ¥
```bash
claude "ä½ å¥½"
```
åº”è¯¥èƒ½è¿æ¥åˆ°æœˆä¹‹æš—é¢APIå¹¶æ­£å¸¸å›å¤ã€‚

## ğŸ¯ æ¨èæ“ä½œ

1. **ç«‹å³æ‰§è¡Œ**: ç¡®ä¿Routeré…ç½®æ­£ç¡®
2. **æµ‹è¯•è¿æ¥**: ä½¿ç”¨å¯åŠ¨è„šæœ¬æµ‹è¯•
3. **å¦‚æœä»æœ‰é—®é¢˜**: è¿è¡Œå®Œå…¨é‡è£…

## ğŸ“ æä¾›çš„æ–‡ä»¶

- `start-claude-clean.ps1` - æ¸…æ´å¯åŠ¨è„šæœ¬
- `fix-auth-simple.bat` - è®¤è¯ä¿®å¤è„šæœ¬  
- `config-fixed.json` - æ­£ç¡®çš„Routeré…ç½®
- `reinstall-claude-oneclick.bat` - ä¸€é”®é‡è£…è„šæœ¬

è®¤è¯å†²çªé—®é¢˜å·²ç»è§£å†³ï¼Œç°åœ¨ä¸»è¦æ˜¯ç¡®ä¿Claude Codeä½¿ç”¨æ­£ç¡®çš„APIç«¯ç‚¹ï¼
